title: "project_aa"
author: "01221975, 01365564, 01381311, 01417146, 01419237, 01428264"
date: "9/20/2017"
output:
  html_document: default
  pdf_document: default
---
```{r packages, echo = FALSE, message=FALSE, warning=FALSE,}
library(readxl)
library(ggplot2)
library(knitr)
library(dplyr)
library(rlang)
library(dplyr)
library(tidyr)
library(rgdal)
library(plyr)
library(rgeos)
library(stargazer)
library(SPARQL)
library(RColorBrewer)
library(corrplot)
library(modelr)

```

#Analysing crime in London

```{r, echo = FALSE}
crime <- read_excel("Official_data/london-ward-well-being-probability-scores.xls", sheet = "Data")
# data by borough
crime_borough <- crime[c(2,629:660),]
crime_borough[,5:ncol(crime_borough)] <- sapply(crime_borough[,5:ncol(crime_borough)],as.numeric)
# data by ward
crime_ward <- crime[2:626,]
crime_ward[,5:ncol(crime_ward)] <- sapply(crime_ward[,5:ncol(crime_ward)],as.numeric)

```


## Introduction
Modern policy regarding crime rate has transitioned to a focus on preventative measures as opposed to consequential punishment. As outlined by Crawford and Evans (2017) these policies focus on early intervention and improving well-being to secure community safety. Mayor theoretical and empirical work in criminology suggests a relation between levels in crime and wellbeing (Kawachi, Kennedy and Wilkinson, 1999). A comprehensive understanding of demographic variables that are highly correlated and plausibly causing crime rates is necessary for developing robust policies. Crime rate in London varies drastically by area. In 2013, crime rates ranged from 13.93 to 222.92, with a mean of 82.40 and a standard deviation of 30. With such drastically different levels of crime and significant outliers, there must be an underlying explanation.

The dataset used in this report is from London datastore, an open data-sharing platform with statistics provided from the London mayoral office. The data is from 2013 and its original purpose was to assign a well-being score to different wards in London through measurements of 12 different indicators such as childhood obesity and deliberate fires. However, this report will focus on crime rates in London and explore the relationships between these rates and other demographic features of wards. It will attempt to model crime based on these additional indicators of well-being. Any significant results may prove to be insightful for policy makers considering local crime rates.

## Dataset description
Information on the 12 key indicators of well-being are given for 625 wards in London over a four-year time frame from 2009 to 2013. Additional borough-wide information is provided for the 32 London boroughs. The variables are split into 8 different categories, detailed below, aiming to give a holistic view of the standard of well-being in the different areas of the capital.

### Variables

```{r, echo = FALSE}
var_1 <- read_excel("Official_data/Variables.xlsx", na = "empty")
var_2 <- var_1[, 1:3]
kable(var_2, format = "html")
```

## Hypothesis
In this report, we will attempt to model crime rates in London wards on factors that signify overall well-being within the ward. Our hypothesis is that crime is dependent on demographic factors and well-being.


## Strength and limitations

Crime, in general, is very hard to measure and as in various big cities around the world, measuring crime in London is no easy task. Police statistics is usually the only measure to local crime. However, police crime figures are not always accurate as they tend to understate recorded crime statistics. Accordingly, crime statistics needs to be investigated with caution; sometimes data from hospitals intakes or victim surveys infer very different theories. 

## Overview analysis
### Crime by borough

From 2009 to 2013, the crime rates of all boroughs in London have decreased. As seen in the maps of figure below, the boroughs in the outskirts of London seem to have a lower crime rate than the boroughs in the center of London with exception to the City of London. 

```{r crime_by_borough, message=FALSE, warning=FALSE, results='hide',echo=FALSE,fig.cap="Crime rate by borough from 2009 to 2013"}
#selects relevant columns: borough (4) and all crime levels (25:29) and stores in crime_data_by_borough. Note boroughs are repeated because data is for wards

crime_data_by_borough <- crime_borough[c(4,25:29)]

#adds new column names to crime_data_by_borough
colnames(crime_data_by_borough) <- c("borough", "2009", "2010", "2011","2012","2013")

#calculates the average crime level data per year for each borough
crime_data_borough_averages <- aggregate(crime_data_by_borough[, 2:6], list(crime_data_by_borough$borough), mean)

#adds new column names to crime_data_borough_averages
colnames(crime_data_borough_averages) <- c("borough", "2009", "2010", "2011","2012","2013")

#calculates the growth of crime per borough
growth <- (crime_data_borough_averages$`2013` - crime_data_borough_averages$`2009`)/crime_data_borough_averages$`2009`*100

#Adds growth vector to crime_data_borough_averages
crime_data_borough_averages$growth <- growth

#Reads boroughs data as SpatialPolygonsDataFrame
london_boroughs <- readOGR(dsn = "Official_data/Map_data/LondonBoroughs.shp") 

#joins london_boroughs@data with crime_data_borough_averages based on the borough
london_boroughs@data <- left_join(london_boroughs@data, crime_data_borough_averages, by = c('name' = 'borough'))

london_boroughs_f <- fortify(london_boroughs)
# allocate an id variable to the sp d
london_boroughs$id <- row.names(london_boroughs)
# join the data
london_boroughs_f <- left_join(london_boroughs_f, london_boroughs@data) 

#changes the structure of the dataset to be able to plot it to a graph
london_boroughs_f_long <- gather(london_boroughs_f, crime_rate_year, crime_rate, -long, -lat, -order, -hole,-piece,-id,-group,-ons_label,-name,-Partic_Per,-Pop_2001, -PopDensity, -AREA, -PERIMETER, -PopDen, -growth)

ggplot(data = london_boroughs_f_long, # the input data
       aes(x = long, y = lat, fill = crime_rate, group = group)) + # define variables
  geom_polygon() + # plot the boroughs
  geom_path(colour="white", lwd=0.05) + # borough borders
  coord_equal() + # fixed x and y scales
  facet_wrap(~ crime_rate_year) + # one plot per year
  scale_fill_gradient2(low = "#64B5F6",high = "#2196F3", # colors
                        name = "Crime rate") + # legend options
  theme(axis.text = element_blank(), # change the theme options
        axis.title = element_blank(), # remove axis titles
        axis.ticks = element_blank()) # remove axis ticks



```

City of London, remains with the lowest rate of crime across all boroughs with only 14 offences per 1,000 daytime inhabitants in 2013. In contrast, its neighbouring boroughs as Lambeth, Hackney, Southwark and Islington continue to present a crime rate of over 100. The map below shows the quartile with the highest number of crime rates in London (crime rate over 90). These boroughs are mainly located to the upper and lower side from the City of London. 

```{r boroughs_with_high_crime_rate, message=FALSE, warning=FALSE, results='hide',echo=FALSE, fig.height = 4, fig.width = 5, fig.cap="Crime rate > 90 (2013)"}
#plots the boroughs with highest crime rate of 100
ggplot(london_boroughs_f, aes(long, lat, group = group, fill=`2013`>90)) +
  geom_polygon() + geom_path(colour="white", lwd=0.05) + coord_equal() +
  labs(x = "lat", y = "lon",
       fill = "Crime rate > 90") +
  scale_fill_manual(values=c("#BDBDBD","#2196F3")) +
  ggtitle("Crime rate > 90 (2013) ") +
  theme(axis.text = element_blank(), # change the theme options
        axis.title = element_blank(), # remove axis titles
        axis.ticks = element_blank()) # remove axis ticks
```

On average, boroughs have lowered their crime rates by 19% from 2009 to 2013. The boroughs that seem to be showing the highest decrease in crime rate are on the further southeast of London, as for instance in Greenwich, Barking and Dagenham and Lewisham. The boroughs with the least progress in decreasing crime are Tower Hamlets, Enfield and Kensington and Chelsea. 

```{r crime_rate_growth, message=FALSE, warning=FALSE, results='hide',echo=FALSE, fig.height = 4, fig.width = 5, fig.cap="Decrease of crime rates by borough from 2009 to 2013"}
ggplot(data = london_boroughs_f, # the input data
       aes(x = long, y = lat, fill = growth, group = group)) + # define variables
  geom_polygon() + # plot the boroughs
  geom_path(colour="white", lwd=0.05) + # borough borders
  ggtitle("Decrease of crime rates by borough from 2009 to 2013 ") +
  coord_equal() + # fixed x and y scales
  scale_fill_gradient2(low = "#66BB6A",high = "#4CAF50", # colors
                        name = "Decrease (%)") + # legend options
  theme(axis.text = element_blank(), # change the theme options
        axis.title = element_blank(), # remove axis titles
        axis.ticks = element_blank()) # remove axis ticks
```

### Crime by ward

An aspect of note regarding crime rates across wards, is that the majority of wards in London have a crime rate smaller than the mean. This aspect is illustrated on the histogram below, where, compared to the normal distribution, the crime rate data from 2013 is skewed towards the left. This will have furthur implications on possible regressions, to be examined furthur. 
 

```{r, echo = FALSE}
 
ggplot(crime_ward, aes(x = `Crime rate - 2013`)) + 
  geom_histogram(aes(y = ..density..), binwidth = 7,
  colour="black", fill="white") +
  geom_density() +
  geom_vline(aes(xintercept=mean(`Crime rate - 2013`)), 
      color="red", linetype="dashed", size=0.5) +
    stat_function(fun = dnorm, args = list(mean = 
      mean(crime_ward$`Crime rate - 2013`), 
      sd = sd(crime_ward$`Crime rate - 2013`)))
```


### Crime historically

```{r}

# selects relevant data from the whole dataset. Borough and crime rate on each of the 5 years.
crime_by_year <- crime_borough[, c(4, 25:29)]

# changes the names of the coloumns
colnames(crime_by_year) <- c("Borough", "Crime_Rate_2009", "Crime_Rate_2010", "Crime_Rate_2011","Crime_Rate_2012","Crime_Rate_2013")

# # plot the crime rate of 2009 for each borough
# ggplot(crime_by_year, aes(Borough, Crime_Rate_2009)) +
#   geom_bar(stat = "identity") +
#   theme(axis.text = element_text(angle = 45, hjust = 1)) +
#   ylim(0, 150)
# 
# # plot the crime rate of 2010 for each borough
# ggplot(crime_by_year, aes(Borough, Crime_Rate_2010)) +
#   geom_bar(stat = "identity") +
#   theme(axis.text = element_text(angle = 45, hjust = 1)) +
#   ylim(0, 150)
# 
# # plot the crime rate of 2011 for each borough
# ggplot(crime_by_year, aes(Borough, Crime_Rate_2011)) +
#   geom_bar(stat = "identity") +
#   theme(axis.text = element_text(angle = 45, hjust = 1)) +
#   ylim(0, 150)
# 
# # plot the crime rate of 2012 for each borough
# ggplot(crime_by_year, aes(Borough, Crime_Rate_2012)) +
#   geom_bar(stat = "identity") +
#   theme(axis.text = element_text(angle = 45, hjust = 1)) +
#   ylim(0, 150)
# 
# # plot the crime rate of 2013 for each borough
# ggplot(crime_by_year, aes(Borough, Crime_Rate_2013)) +
#   geom_bar(stat = "identity") +
#   theme(axis.text = element_text(angle = 45, hjust = 1)) +
#   ylim(0, 150)

#Average crime over the 5 years, per borough
average <- crime_by_year %>% mutate(average = (Crime_Rate_2009 + Crime_Rate_2010 + Crime_Rate_2011 + Crime_Rate_2012 + Crime_Rate_2013)/ 5)


# ggplot(average, aes(Borough, average)) +
#   geom_bar(stat = "identity") +
#   theme(axis.text = element_text(angle = 45, hjust = 1)) +
#   ylim(0, 150)

ggplot(average, aes(Borough, average)) +
  geom_point() +
  theme(axis.text = element_text(angle = 45, hjust = 1))


crimerateaverage <- gather(average, Year, Rate, Crime_Rate_2009:average)

ggplot(crimerateaverage, aes(x = Borough, y = Rate)) + 
  geom_bar(stat = "identity") +
  theme(axis.text = element_text(angle = 45, hjust = 1)) +
  ylim(0, 150) +
  facet_wrap(~ Year)

crimerate <- gather(average, Year, Rate, Crime_Rate_2009:Crime_Rate_2013)

ggplot(crimerate, aes(Borough, Rate)) +
  geom_point(aes(color = factor(Year), shape = factor(Year))) +
  theme(axis.text = element_text(angle = 45, hjust = 1)) +
  ylim(0, 150)


summary(crime_by_year)



```

Looking at crime rates across the five years, we can see clear trend of crime rates decreasing from 2009 till 2013 across all the London boroughs. The bar plots, for each year, show the crim rates per borough for that specific year. If you compare the 5 plots, you will notice that the crime rates are decreasing year by year.

The scatter plot shows the average crime rate (over the 5 years) across each borough. One thing to note, is the City of London, which has the lowest crime rate across all of London. 


# Correlation Analysis
The correlation analysis in this report adopts the Pearson correlation coefficient, denoted r, with the aim to examine the strength and direction of the linear relationship between two continuous variables, i.e. crime rate and one of the other rates.The correlation coefficient ranges from −1 to +1, and a stronger relationship between two variables as a larger absolute value of the coefficient. Positive coefficient means both variables tend to increase or decrease together whereas negetive coefficient means two variables have opposite directions (Zhou et al., 2016).

The following correlation analysis does not conclude that changes in one variable cause changes in crime rate or changes in crime rate cause in other variable. This analysis will not tell whether a relationship is causal;however, these will be answered in the regression part.


##Test of correlation 
The following part will test the significant of the correlation between crime rates and other variables.

```{r}
cor_test_pvalue <- c()
cor_test_cor <- c()
variable_name<-c("life_expectancy","childhood_obesity","incapacity_benefit","unemployment_rate","deliberate_fires","GCSE_point","unauthorised_absence","dependent_children","public_transport","home_access", "subjective_well_being")
for (i in seq(from = 9, to = 64, by= 5 )){
  if (i != 29){
  cor_test <- cor.test(crime_ward[[i]],crime_ward[[29]])
  cor_test_pvalue <-c(cor_test_pvalue,round((cor_test$p.value),4))
  cor_test_cor <- c(cor_test_cor, round((cor_test$estimate[[1]]),4))
  }
}

cor_test_df <- data.frame(variable_name,cor_test_cor,cor_test_pvalue)
cor_test_df <- cor_test_df %>% arrange(desc(cor_test_pvalue))
names(cor_test_df)[1]<-paste("Variable Name")
names(cor_test_df)[2]<-paste("Correlation Coefficient")
names(cor_test_df)[3]<-paste("P-Value")
kable(cor_test_df)
```

We would like to examine whether the correlation between crime rate and one of the other variables is significant by comparing the p-value to a certain significance level, denoted α. 

The significance level refers to a certain degree of risk of concluding that a diffrence exists while in fact there is no diffrence. We belive a significance level of 0.05 is fair enough for this report. Therefore, if the p-value of a correlation test is less than or equal to α, we would conclude that the correlation is statistically significant and would be further discussed.

We then remove subjective well-being score and the proportion of accessing to public open space and nature from our further discussions. In addition, we exclude deliberate fire becasue it has a relatively low correlation with crime rate (approximatedly 0.13), the rate which is not significant enough as a rule of thumb.

Therefore, we would only focus on the following variables in the following analysis.


```{r}
# crime_ward_2013
crime_ward_2013 <- crime_ward[,c(3,4,seq(9,64,5))]
colnames(crime_ward_2013) <- c("Ward", "Borough","life_expectancy","childhood_obesity","incapacity_benefit","unemployment_rate","crime_rate","deliberate_fires","GCSE_point","unauthorised_absence","dependent_children","public_transport","home_access","well-being")
# the codes below define a function that allows you to make scatters boxplot with correlation on them
# argument: col_name, string with double quotes, e.g. "unemployment_rate"
cor_plot <- function(col_name) {
  corr <- data.frame(r=round(cor(crime_ward_2013[[col_name]],crime_ward_2013[,"crime_rate"]),4))
  print(ggplot(crime_ward_2013,aes_string(x=col_name,y="crime_rate")) + geom_point(alpha=0.2) +
    geom_smooth(method = "lm") +
    geom_text(data=corr, aes(label=paste("r=",crime_rate,sep="")),x=quantile(crime_ward_2013[[col_name]],0.9),y=200) )

}
# example: cor_plot("unemployment_rate")
```

### Life Expectancy

According to the data description provided by London datastore, rolling 5-year combined life expectancies instead of simple one-year life expectancies are used for wards to reduce the effects of the variability in number of deaths in each year.

In the past few years, violence has been started to be considered a publich health issue. Areas with high crime rates tend to have higher mortality rates from all causes as well (Kawachi, Kennedy and Wilkinson, 1999). 

A study in 2015 reviewed that biological aging processes may be impacted by socioeconomic milieu, meaning that those who living in noisy area with high crime may have shorter cellular aging estimated by leukocyte telomere length (Park et al., 2015). Therefore, it is reasonable to estimate that a negative correlation between crime rate and life expectancy.


```{r}
cor_plot("life_expectancy")
```

From the above scatter point graph, moderate negative relationship between crime rate and life expectancy can be found, with Pearson r -0.3631. Also, a significant portion of points are far from the smooth line indicates only a moderate linear relationship between the variables.

### Childhood Obesity

Children with a Body Mass Index (BMI) greater than or equal to the 95th centile of the British 1990 growth reference (UK90) BMI distribution have been classified as obese. The Childhood Obesity rate are combined by the latest three years of National Child Measurement Programme (NCMP) data. This means, the data we use is the average of data in 2011, 2012, and 2013. 

An et al. (2017) revealed a  modest relationship between residential neighbourhood safety and weight-related behaviours/outcomes among children and adolescents through examing 22 studies, Half of which conducted in the USA, and one of which was conducted in a developing country. There analysis suggested that living in district with relatively high crime rate  was associated with a reduction in children's physical activity, and therefore gain in body mass index, but no change in childhood obesity risk.

At the same time, Sandy, Robert et al., (2013) work suggests that violent crimes alone seem to significantly increase children's weight. This seems to be due to the fact that the use of community areas is closely related to its safety. 

Therefore, we expect childhood obesity rate and crime rate have moderate positive correlation before actually conducting the analysis.

```{r}
cor_plot("childhood_obesity")
```







Similar to the correlation between crime rate and life expectancy, crime rate and childhood obesity share a moderate positive relationship, with r of 0.3757.

The analysis results confirm our expectation based on the study conducted by An et al. (2017). It is noticebaly that expect for in year 2013, wards that have extremely high childhood obesity score tend to have lower crime rate, the phenomenon violate the moderate positive relationship between the two variables.

###Incapacity Benefit

Incapacity Benefit rate represents Incapacity Benefit or Severe Disablement Allowance claimant rate. Incapacity Benefit (IB) is paid to people who are incapable of work and who meet certain contribution conditions and Severe Disablement Allowance (SDA) is paid to those unable to work for 28 weeks in a row or more because of illness or disability.

```{r}
cor_plot("incapacity_benefit")
```
Again crime rate and incapacity benefit rate have a moderate positive relationship, with a r equals to 0.3917 in 2013. The moderate correlation may be explained by many extreme data values since the Pearson correlation coefficient is very sensitive to extreme data values. A single value that is very different from the other values in a data set can greatly change the value of the coefficient. 


###Unemployment Rate
Unemployment rate here refers to percentage of working-age residents claiming Jobseeker's Allowance (JSA) or National Insurance Credits. JSA is a benefit payable to unemployed people so presumably the percentage can be used to estimate unemployment rate. 
A study found significantly positive effects of unemployment on property crime rates using US state data (Raphael and Winter‐Ebmer, 2001). Although we do not have crime rate data of different types of crimes (i.e. property crime), we expect the relation of crime rate in general and unemployment rate to be positively correlated.

```{r}
cor_plot("unemployment_rate")
```
Our scatter plot shows moderate positive correlation between the two variables, which confirmed our hypothesis. The wards with higher unemployment rates are likely to have higher crime rates. 

###Education (GCSE Score and Unauthorised Pupil Absence)
GCSE average point scores refers to GCSE and Equivalent point scores for pupils at the end of Key Stage 4 (KS4) in maintained schools. Unauthorised Absence is absence without permission from a teacher or other authorised representative of the school. Wards with higher GCSE scores and lower unauthorised pupil absence suggect higher education well-being. Not surprisingly, these two variables have negatively relationship with a correlation of -0.5979. 

```{r}
# correlation between GCSE & unauthorised pupil absence
cor(crime_ward_2013$GCSE_point, crime_ward_2013$unauthorised_absence)
```
The research of Lochner and Moretti (2004) shows that schooling significantly reduces criminal activity. We expect to see a negative relationship between GCSE score and crime rate but a positive relationship between unauthorised pupil absence. 
```{r}
# plot education varialbes
cor_plot("GCSE_point")
cor_plot("unauthorised_absence")
```
As we can see from the scatters, the relationships are consistant from our expectation. However, correlations (-0.33 and 0.374) between education variables and crime rate are relatively weaker compared with unemployment. Both of the variables are all related to primary school education. If we can also combine data from secondary school or even university to create a complete picture of education, it may reveal a stronger relationship with crime rate. 

### Dependent children
Dependent children are the percentage of children living in out-of-work benefit claimant households, which represents the number of children dependent on a parent or guardian who is claiming one or a combination of out-of-work benefits. In general, people may believe that dependent children are associated with the crime rate. According to correlation statistics and graph below, there is a moderate positive correlation (0.4654) indicates that boroughs with higher dependent children percentage tend to have a higher crime rate.

From the table x above, the p-value of correlation test between the dependent children and the crime rate is much less than 5% significance level. So we are confident to reject the null hypothesis, which states that there is a linear relationship between these two variables. we can then conclude that dependent children is positively correlated with crime rate. The borough area that have more dependent children are likely to have a higher crime rate. In the following analysis, we will come back to analyse our discover by rigorous regression analysis.

```{r}
# plot children varialbes
cor_plot("dependent_children")
```

# corr analysis last part
### deliberate_fires
Gannon, T. A., & Pina, A. (2010). study on firesetting theory and treatment shows that firesetters are often part of a myriad of violent or property crimes. Research by Hill et al (1982) found a large majority of firesetters had already engaged in one or more recorded criminal charges. With this in mind, an incresae deliberate fires might suggest an increase of other crimes. We therefore think there might be a relation between the number of delibearte fires and crime rates. 


```{r}
cor_plot("deliberate_fires")
```
The correlation between crime rate and figure of deliberate fires per 1000 population is very weak throught the 5 years, correlation figure fluctuates around 0.13. Although deliberate fire expects to be a great indicator, as this directly relates to crime rate; the correlation figure shows a weak relationship. It is sugguested to have further investigations of this factor


### Environment (Access to public open space and nature	Measure of proportion of area that is greenspace and accessibility from homes)
```{r}
cor_plot("home_access")
```
It is clearly seen from the graph x that there is almost no correlation between crime rate and environment, the correlation figures remained extremely low across 5 years. In common sense, we may expect the environment could be a potential drive of leading committing a crime, the result proves that people tend to be rational with their actions regardless of their surrounding environment

### Access	Public Transport Accessibility Scores	Measure of the accessibility of a point to the public transport network
```{r}
cor_plot("public_transport")
```
Public transport accessibility scores measure the accessibility of a point to the public transport network. From terrorist attack records, it is observed that many crime events happened in the public transport accessibility area. Because it is extremely difficult to control many citizens flow in such areas; in particular, subway and train stations. Therefore, it is commonly believed that public transport accessibility area is highly associated with the crime rate. From the correlation statistics and graph below, there is a moderate positive correlation (0.4421), means that boroughs with better public accessibility are likely to have a higher crime rate.

According to the above table x, the correlation test statistics between the public transport accessibility and the crime rate is significant with P-value being much less than the significance level. So we can reject the null hypothesis, indicates that there is a linear relationship between these two variables. We can conclude that public transport accessibility is positively correlated with the crime rate.  In the following analysis, we will come back to analyse our discover by rigorous regression analysis.











##Correlation Matrix
Finally, we study the correlation between any two variables by construsting a correlation matrix. Before we get into , we notice that some of our independent variables are highly correlated, suggesting multicollinearity exists which can impact the model fits. 

```{r}
cor_mat_df<-round(cor(select(crime_ward_2013, -Ward, -Borough, -home_access, -`well-being`, -deliberate_fires)),4)
kable(cor_mat_df)
#first colour is for negative values and second for positive
col1 <- colorRampPalette(c('#CDDC39','#03A9F4')) 
corrplot(cor_mat_df,method = "square", order = "FPC", tl.col = "black", tl.cex = 0.75,, sig.level = 0.05, insig = "pch", pch.cex = 1, col = col1(100))


```




	
## Linear regression
In this section, we will attempt to model crime rates on a series of independent variables relating to well-being in London. As previously discussed, measures of greenspace, subjective well-being and deliberate fires rates will be neglected in this model due to low levels of significant correlation. Variables capturing levels of incapacity benefits and of children in out-of-work households will also be excluded due to high levels of correlation with the other remaining independent variables. 

The model created uses OLS or ordinary least squares to form a linear regression that minimizes the sum of the squared difference between the estimated and original values of the dependent variable.  As previously mentioned, the distribution of the crime rate in 2013 across wards was negatively skewed. Because OLS assumes a normal distribution of the dependent variable, it will be transformed logarithmically to improve its distribution.

```{r}
# first and second regression
log_lin_full <- lm(log(crime_rate) ~ life_expectancy + childhood_obesity + 
                     unemployment_rate + GCSE_point + unauthorised_absence + 
                     public_transport, data = crime_ward_2013)
log_lin1 <- lm(log(crime_rate) ~ life_expectancy + unemployment_rate + 
                 unauthorised_absence + public_transport , data = crime_ward_2013)

plot(log_lin1)
# comparison
stargazer(list(log_lin_full, log_lin1), type = 'text', digits = 2)
```

The first six-variable regression revealed a non-significant causal relationship between crime rate and the prevalence of childhood obesity, as well as, average GCSE scores. These will therefore be excluded from the final regression. The second regression models crime rate on a collection of 4 continuous variables: average life-expectancy, unemployment rate, unauthorized absence in school and accessibility to public transport. These four variables are all individually significant at the 95% confidence interval. The overall model has an adjusted R-squared of 37%. Albeit moderate, this measure of the degree to which the chosen variables are able to explain the variance in the crime rate is significant at the 95% interval. 

```{r, echo = FALSE}
res_plot <- add_residuals(crime_ward_2013, log_lin1, "Residuals") 
ggplot(res_plot, aes(crime_ward_2013$crime_rate, Residuals)) +geom_point()
```


Hence, we are unable to reject the null that crime rate can be explained by a series of well-being indicators.



## Conclusion and analysis

[TEXT]

The model shows a negative relationship between crime rate and life expectancy, suggesting that a healthier ward encourages less crime. ___

Secondly the relationship between crime rates and unemployment rate is positive, meaning that a more unemployed population is more likely to commit crime, possibly attributed to increased anti-social behavior or need of alternative income. ___

The variable capturing the level of unauthorized absence in schools, as expected has a positive relationship with crime. This could be as a result of ___

Public transport seems to have a positive relationship with crime. This seems contradictory as the well-being report assumes that access to public transport improves overall well-being of the ward. It may, however, be the case, that increased public transport increases human traffic and so the likelihood of crime increases. ____

These variables only tell part of the story.

[TEXT]

#Bibliography

Gannon, T. A., & Pina, A. (2010). Firesetting: Psychopathology, theory and treatment.
Aggression and Violent Behavior. 15, 224-238.

Hill, R. W., Langevin, R., Paitich, D., Handy, L., Russon, A., & Wilkinson, L. (1982). Is arson an aggressive act or a property offense? A controlled study of psychiatric referrals.
Canadian Journal of Psychiatry, 27, 648-654.

Kawachi, I., Kennedy, B.P., Wilkinson, R.G., 1999. Crime: social disorganization and relative deprivation. Social Science & Medicine 48, 719–731. 

Lochner, L. and Moretti, E. (2004). The Effect of Education on Crime: Evidence from Prison Inmates, Arrests, and Self-Reports. American Economic Review, 94(1), pp.155-189.

Raphael, S. and Winter‐Ebmer, R. (2001). Identifying the Effect of Unemployment on Crime. The Journal of Law and Economics, 44(1), pp.259-283.

Sandy, R., Tchernis, R., Wilson, J., Liu, G., Zhou, X., (2013). Effects of the Built Environment on Childhood Obesity: the Case of Urban Recreational Trails and Crime. Economics and human biology 11, 18–29. 

