{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Exercises week 4\"\nauthor: \"Valeria Cortez\"\ndate: ''\noutput:\n  pdf_document: default\n  html_document: default\n---\n\n##Exercise 1\n\n*The States dataset has some information about US states. You can find this dataset in the `car` package.*\n\n```{r, echo = TRUE}\nlibrary(car)\nst <- States\n# This is for convenience and transforms the rownames into an additional column\nst[, \"States\"] <- rownames(st)\n# You can access the description of the dataset with the following:\n# ?States\n\n```\n\n**1. Examine the correlations between the SATV and SATM scores. Can you explain your finding in one or two sentences?**\n\n```{r, echo = TRUE}\n# Your code here\ncor(st$SATV,st$SATM)\n```\nRESPONSE: There is a positive and strong relationship between `SATV` and `SATM` given that their correlation is `0.96`. \n\n\n**2. Examine the correlations between the state spending on public education (dollars) and the 2 different SAT scores. Can you explain what you find in one or two sentences?**\n\n```{r, echo = TRUE}\n# Your code here\nlibrary(ggplot2)\ncor(st$dollars,st$SATV)\ncor(st$dollars,st$SATM)\n\nggplot(st, aes(x=dollars, y=SATV)) + geom_point() + geom_smooth(method = \"lm\")\n```\nRESPONSE: There is negative correlation between each exam of the SAT exams with the state's spending on public education. That means that higher spending does not mean better grades.  \n\n\n**3. Create a plot showing how the SATV and SATM scores covary with the average teacher's salary (pay).**\n\n```{r}\n# Your code here\nggplot(st) + geom_point(aes(x=pay ,y=SATV,col=\"SATV\")) +  geom_point(aes(x=pay ,y=SATM,col=\"SATM\")) + geom_smooth() scale_y_continuous(name=\"SAT score\") \n```\n\n\n\n**4. Can you build a simple linear regression model trying to explain the SATM score (but not including the SATV score as a variable)? Explain why you include each of the variables in your model: what leads you to think this variable will have an effect on the score (Write no more than 3-5 sentences)?**\n\n```{r, echo = TRUE}\n# Your code here\ncor.test(st$dollars,st$SATM)\ncor.test(st$pop,st$SATM)\ncor.test(st$percent,st$SATM)\ncor.test(st$pay,st$SATM)\n\n\nm_satm <- lm(SATM ~ dollars + percent, data=st)\nsummary(m_satm)\n```\nRESPONSE: For the linear regression model, I used the variables `dollars` and `percent`. I selected the both numerical variables because they show a strong correlation for an analysis using social economical data and also presented a p-value below `0.05` when combined together in the linear model. I would have been interested to use `States`, given that each state might have different characteristics, including different administrative bodies for education and regulations, which might affect `SATM` scores. However, we don't have enough data for `States` to include them in the model.\n\n\n##Exercise 2\n\n*The nuclear dataset in the `boot` package contains information about nuclear power station construction data.*\n*This dataset has 32 rows and 11 columns.*\n\n\n```{r, echo = TRUE, message = FALSE}\nlibrary(boot)\nncl <- nuclear\n# You can access a description of the dataset using ?nuclear\n```\n\n*Can you build a simple model of the determinants of cost for this dataset? In this case, your goal is to achieve the largest possible value for adjusted R-square.*\n\n```{r, echo = TRUE}\n# Your code here\n\nmcost <- lm(cost ~ date + t2 + cap +pr, data=ncl)\nsummary(mcost)\n\n```\n\n\n##Exercise 3\n\n*The car package contains a dataset called `Salaries` which gives some information about the faculty in an american college in 2008-2009, including salaries.*\n\n\n```{r, echo = TRUE}\nlibrary(car)\nslr <- Salaries\n# You can access a description of the dataset using ?Salaries\n```\n\n**1. Plotting the relationship between gender (the `sex` variable) and wage (the `salary` variable), does it looks likely that there is gender discrimination (1-2 sentences)?**\n\n```{r, echo = TRUE}\n# Try using ggplot2 with the geom_boxplot type.\nlibrary(ggplot2)\nggplot(slr, aes(sex,salary,col=sex)) + geom_boxplot()\n```\nRESPONSE: The median value of the salaries for female and male does not differ so much. However, the range of salaries for men reaches much higher values as for the ones of women, which might lead to think that women are not making it to the top.\n\n**2. Redo the previous plot, but this time separating the plot by rank. Does discrimination looks likely (1-2 sentences)?**\n\n```{r, echo = TRUE}\n# Try using ggplot2 with the geom_boxplot type.\nggplot(slr, aes(sex,salary,col=sex)) + geom_boxplot() + facet_wrap(~rank)\n```\nRESPONSE: As in the chart before, we can see that the median values of salaries is slightly higher for men than for women, but the difference is not very large. There are only 39 entries for women in the whole dataset, which is not enough data to draw conclusions whether the difference in the median value for the salaries of women and men explais any discrimination.\n\n**3. Can you build a regression model that examine the effect of gender on salary? When you add additional variables, does the relationship between salary and gender changes? What else influences salary? (Write no more than 3-5 sentences)**\n\n```{r}\n# Your code here\nm_sal_gen <- lm(salary ~ sex, data=slr)\nm_sal_all <- lm(salary ~ sex + rank + discipline + yrs.since.phd + yrs.service, data=slr)\nsummary(m_sal_gen)\nsummary(m_sal_all)\n```\nRESPONSE: When we only analyse salary as a function of gender in a linear model, we notice a significant relation between the two. However, as soon as we add more variables to the model as rank, discipline, yeras since phd and years since service, we can see that gender is not longer significant. Being a professor and/or being part of an 'applied' department can lead to better prediction of salary based on the model with all the variables: `lm(formula = salary ~ sex + rank + discipline + yrs.since.phd + yrs.service, data = slr)`. Other variables as `yrs.since.phd` and `yrs.service` also apply in this model, but with less accuracy.\n\n**4. Would you recommend that this college take action about its salary structure? Would you take any other actions? (3-5 sentences)**\n\nRESPONSE: Based on the data, I woudl recommend the college to look at the professors that are getting paid high amounts. The boxplot showed some high outliers that shoudl be considered. In terms of gender, there are only 39 women versus 358 to in the sample to make a proper assesment whether this group is being paid less just because of their gender. However, the low number of female representatives should trigger an alert to analyse why so there are so few women in this college. Some research topics could be \"are women facing discrimination in the hiring process\", \"why are women quiting their jobs at the college\" or \"are enough women applying for jobs at the college\".\n",
    "created" : 1506523918579.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1638481495",
    "id" : "9DC0001B",
    "lastKnownWriteTime" : 1506606915,
    "last_content_update" : 1506607282761,
    "path" : "~/Google Drive/Imperial/Math and Statistics/exercises/exercises_week4.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}